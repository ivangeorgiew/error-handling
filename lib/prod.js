"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function _iterableToArrayLimit(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var n=[],t=!0,o=!1,i=void 0;try{for(var c,a=r[Symbol.iterator]();!(t=(c=a.next()).done)&&(n.push(c.value),!e||n.length!==e);t=!0);}catch(r){o=!0,i=r}finally{try{t||null==a.return||a.return()}finally{if(o)throw i}}return n}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function ownKeys(e,r){var n,t=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)),t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _defineProperty(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var getErrorHandling=function(t){function f(r){return"function"!=typeof r&&r===Object(r)}function s(r){try{return JSON.stringify(r,function(r,n){return n instanceof Error?Object.getOwnPropertyNames(n).reduce(function(r,e){return r[e]=n[e],r},{stack:n.stack}):"function"==typeof n?"[function]":n})}catch(r){return JSON.stringify("[object Cyclic]")}}function l(r){var e="boolean"==typeof(r=f(r)?r:{}).descr&&r.descr,n="string"==typeof r.descr?r.descr:e?"unexpected error, plese reload...":d;try{var t=r.err instanceof Error?r.err:new Error("Unknown error"),o=Array.isArray(r.args)?r.args.map(function(r){return JSON.parse(s(r))}):["[unknown]"],i=o.reduce(function(r,e,n){var t=s(e);return 0===n?"".concat(r," ").concat(t):"".concat(r," , ").concat(t)},"");g&&h(" Issue with: ".concat(n,"\n Function arguments: ").concat(i,"\n"),t);var c={description:n,arguments:o,date:(new Date).toUTCString(),error:t},a=s(c);return u&&(a=s(_objectSpread(_objectSpread({},c),{},{localUrl:window.location.href,machineInfo:{browserInfo:window.navigator.userAgent,language:window.navigator.language,osType:window.navigator.platform}}))),y&&(a=s(_objectSpread(_objectSpread({},c),{},{localUrl:__filename,machineInfo:{cpuArch:process.arch,osType:process.platform,depVersions:process.versions}}))),{description:n,productionMsg:a}}catch(t){return g&&h(" Issue with: error logger\n",t),{description:n,productionMsg:s({description:n,error:t})}}}function p(i,c,a,r){var s=3<arguments.length&&void 0!==r&&r;try{if("function"!=typeof c)return l({err:new Error("Instead of function was given ".concat(c))}),function(){};var u=function(r,e){if(v(l({descr:i,err:r,args:e})),"function"==typeof a)return p("catching errors for ".concat(i),a).call(this,{descr:i,err:r,args:e})};return function(){for(var e=this,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];try{s&&(n=n.map(function(r){return"function"==typeof r?p("argument of ".concat(i),r,a):r}))}catch(r){l({descr:"error handling function arguments",err:r})}try{var o=c.apply(this,n);return f(o)&&"function"==typeof o.catch?o.catch(function(r){return u.apply(e,[r,n])}):o}catch(r){return u.apply(this,[r,n])}}}catch(r){return l({descr:"error handling function",err:r}),"function"==typeof c?c:function(){}}}var u="undefined"!=typeof window&&"[object Window]"==={}.toString.call(window),y="undefined"!=typeof global&&"[object global]"==={}.toString.call(global),o=f(console)&&"function"==typeof console.error?console.error:function(){},d="a part of the application",r=["error","unhandledrejection"],i=["uncaughtException","unhandledRejection","SIGTERM","SIGINT"],g="boolean"==typeof(t=f(t)?t:{}).isDevelopment?t.isDevelopment:!(!f(process)||!f(process.env))&&"production"!==process.env.NODE_ENV,h="function"==typeof t.devErrorLogger?function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];try{t.devErrorLogger.apply(this,e)}catch(r){g&&(o(" Issue with: parameter devErrorLogger\n",r),o.apply(this,e))}}:o,v="function"==typeof t.onError?function(){try{for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];t.onError.apply(this,e)}catch(r){g&&h(" Issue with: parameter onError\n",r)}}:function(){},b=p("creating error handled data",function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var t=e[0],o=e[1],i=e[2];if("string"!=typeof t&&(t=d,o=e[0],i=e[1]),Array.isArray(o))return o.map(function(r,e){return b("element ".concat(e," of ").concat(t),r,i)});if("function"==typeof o||f(o)){var c="function"==typeof o?p(t,o,i,!0):{},a=Object.getOwnPropertyDescriptors(o);return Object.keys(a).forEach(function(r){var e,n;a[r].configurable&&(n="function"==typeof o[r]?p("method ".concat(r),o[r],null!==(e=o[r+"Catch"])&&void 0!==e?e:i,!0).bind(o):o[r],Object.defineProperty(c,r,Object.assign(a[r],a[r].hasOwnProperty("value")?{value:n}:null)))}),c}return o},function(r){var e=_slicedToArray(r.args,2),n=e[0],t=e[1];return"string"==typeof n?t:n}),e=p("listening for unexpected errors",function(r){var e,n;u&&(r instanceof Event&&(r.stopImmediatePropagation(),r.preventDefault(),v(l({isUncaught:!0,err:null!==(e=r.reason)&&void 0!==e?e:r.error}))),window.document.body.style["pointer-events"]="none"),y&&(n=0,r instanceof Error&&(n=1,v(l({isUncaught:!0,err:r}))),setTimeout(function(){process.exit(n)},1e3).unref())}),n=p("initializing listening for unexpected errors",function(){u&&(r.forEach(function(r){"function"==typeof window.__errorListener__&&window.removeEventListener(r,window.__errorListener__,!0),window.addEventListener(r,e,!0)}),window.__errorListener__=e),y&&(i.forEach(function(r){"function"==typeof global.__errorListener__&&process.removeListener(r,global.__errorListener__),process.on(r,e)}),global.__errorListener__=e)}),c=p("initializing error handling for server",function(e){e=f(e)?e:{};var n=new Set;"function"==typeof e.on&&(e.removeAllListeners("connection"),e.on("connection",function(r){n.add(r),r.on("close",function(){n.delete(r)})}));var t=p("handling server closing",function(r){"function"==typeof e.close&&e.close(),n.forEach(function(r){r.destroy()})});return y&&i.forEach(function(r){process.prependListener(r,t)}),e},function(r){return _slicedToArray(r.args,1)[0]});return n(),{isDevelopment:g,devErrorLogger:h,onError:v,isObject:f,isBrowser:u,isNodeJS:y,stringifyAll:s,createData:b,getHandledServer:c}};module.exports=getErrorHandling;