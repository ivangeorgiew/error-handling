"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,e){if(r){if("string"==typeof r)return _arrayLikeToArray(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(r,e):void 0}}function _arrayLikeToArray(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}function _iterableToArrayLimit(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var n=[],t=!0,o=!1,c=void 0;try{for(var i,a=r[Symbol.iterator]();!(t=(i=a.next()).done)&&(n.push(i.value),!e||n.length!==e);t=!0);}catch(r){o=!0,c=r}finally{try{t||null==a.return||a.return()}finally{if(o)throw c}}return n}}function _arrayWithHoles(r){if(Array.isArray(r))return r}function ownKeys(e,r){var n,t=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)),t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(n),!0).forEach(function(r){_defineProperty(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _defineProperty(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}var getErrorHandling=function(t){function f(r){return"function"!=typeof r&&r===Object(r)}function a(r){try{return JSON.stringify(r,function(r,n){return n instanceof Error?Object.getOwnPropertyNames(n).reduce(function(r,e){return r[e]=n[e],r},{stack:n.stack}):"function"==typeof n?"[function]":n})}catch(r){return JSON.stringify("[object Cyclic]")}}function l(r){try{var e="string"==typeof(r=f(r)?r:{}).descr?r.descr:s,n=r.err instanceof Error?r.err:new Error("Unknown error"),t=Array.isArray(r.args)?r.args.map(function(r){return JSON.parse(a(r))}):["[unknown]"],o=t.reduce(function(r,e,n){var t=a(e);return 0===n?"".concat(r," ").concat(t):"".concat(r," , ").concat(t)},"");u&&y(" Issue with: ".concat(e,"\n Function arguments: ").concat(o,"\n"),n);var c={description:e,arguments:t,date:(new Date).toUTCString(),error:n},i=a(c);return g&&(i=a(_objectSpread(_objectSpread({},c),{},{localUrl:window.location.href,machineInfo:{browserInfo:window.navigator.userAgent,language:window.navigator.language,osType:window.navigator.platform}}))),h&&(i=a(_objectSpread(_objectSpread({},c),{},{localUrl:__filename,machineInfo:{cpuArch:process.arch,osType:process.platform,depVersions:process.versions}}))),{userMsg:"Issue with: ".concat(e),prodMsg:i}}catch(n){return u&&y(" Issue with: error logger\n",n),{userMsg:"Issue with: ".concat(s),prodMsg:a({description:descr,error:n})}}}function p(c,i,a,r){var s=3<arguments.length&&void 0!==r&&r;try{if("function"!=typeof i)return l({err:new Error("Instead of function was given ".concat(i))}),function(){};var u=function(r,e){if(d(l({descr:c,err:r,args:e})),"function"==typeof a)return p("catching errors for ".concat(c),a).call(this,{descr:c,err:r,args:e})};return function(){for(var e=this,r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];try{s&&(n=n.map(function(r){return"function"==typeof r?p("argument of ".concat(c),r,a):r}))}catch(r){l({descr:"error handling function arguments",err:r})}try{var o=i.apply(this,n);return f(o)&&"function"==typeof o.catch?o.catch(function(r){return u.apply(e,[r,n])}):o}catch(r){return u.apply(this,[r,n])}}}catch(r){return l({descr:"error handling function",err:r}),"function"==typeof i?i:function(){}}}var s="unnamed entity",o=f(console)&&"function"==typeof console.error?console.error:function(){},u="boolean"==typeof(t=f(t)?t:{}).isDevelopment?t.isDevelopment:!(!f(process)||!f(process.env))&&"production"!==process.env.NODE_ENV,y="function"==typeof t.devErrorLogger?function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];try{t.devErrorLogger.apply(this,e)}catch(r){u&&(o(" Issue with: parameter devErrorLogger\n",r),o.apply(this,e))}}:o,d="function"==typeof t.onError?function(){try{for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];t.onError.apply(this,e)}catch(r){u&&y(" Issue with: parameter onError\n",r)}}:function(){},g="undefined"!=typeof window&&"[object Window]"==={}.toString.call(window),h="undefined"!=typeof global&&"[object global]"==={}.toString.call(global),v=p("creating error handled data",function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var t=e[0],o=e[1],c=e[2];if("string"!=typeof t&&(t=s,o=e[0],c=e[1]),Array.isArray(o))return o.map(function(r,e){return v("element ".concat(e," of ").concat(t),r,c)});if("function"==typeof o||f(o)){var i="function"==typeof o?p(t,o,c,!0):{},a=Object.getOwnPropertyDescriptors(o);return Object.keys(a).forEach(function(r){var e,n;a[r].configurable&&(n="function"==typeof o[r]?p("method ".concat(r),o[r],null!==(e=o[r+"Catch"])&&void 0!==e?e:c,!0).bind(o):o[r],Object.defineProperty(i,r,Object.assign(a[r],a[r].hasOwnProperty("value")?{value:n}:null)))}),i}return o},function(r){var e=_slicedToArray(r.args,2),n=e[0],t=e[1];return"string"==typeof n?t:n}),r=p("initializing uncaught error handling",function(){var r=p("handling uncaught errors",function(r){var e,n,t="uncaught error";g&&(r instanceof Event&&(r.stopImmediatePropagation(),r.preventDefault(),d(l({descr:t,err:null!==(e=r.reason)&&void 0!==e?e:r.error}))),window.document.body.style["pointer-events"]="none"),h&&(n=0,r instanceof Error&&(n=1,d(l({descr:t,err:r}))),setTimeout(function(){process.exit(n)},1e3).unref())});g&&(window.addEventListener("error",r,!0),window.addEventListener("unhandledrejection",r,!0)),h&&(process.on("uncaughtException",r),process.on("unhandledRejection",r),process.on("SIGTERM",r),process.on("SIGINT",r))}),e=p("initializing error handling for server",function(e){e=f(e)?e:{};var n=new Set,r=p("handling server closing",function(r){"function"==typeof e.close&&e.close(),n.forEach(function(r){r.destroy()})});return"function"==typeof e.on&&e.on("connection",function(r){n.add(r),r.on("close",function(){n.delete(r)})}),h&&(process.prependListener("uncaughtException",r),process.prependListener("unhandledRejection",r),process.prependListener("SIGTERM",r),process.prependListener("SIGINT",r)),e},function(r){return _slicedToArray(r.args,1)[0]});return r(),{isDevelopment:u,devErrorLogger:y,onError:d,isObject:f,isBrowser:g,isNodeJS:h,stringifyAll:a,createData:v,getHandledServer:e}};module.exports=getErrorHandling;